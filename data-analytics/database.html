<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>User Data</title>
        <style>
            h1 {
                color: #333;
                text-align: center;
            }
            zing-grid {
                display: block;
                margin: 20px auto; 
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.2); 
                border-radius: 10px; 
                overflow: hidden; 
            }
        </style>
        <script src="https://cdn.zinggrid.com/zinggrid.min.js" defer></script>
        <script defer>
            // Function to fetch data using GET request and update ZingGrid
            function fetchDataAndPopulateGrid() {
                // Fetch data for each grid
                ['static', 'performance', 'activity'].forEach(type => {
                    fetch(`https://cse135.cloud/api/${type}_data`)
                        .then(response => response.json())
                        .then(data => {
                            // Process data if this is the activity grid
                            if (type === 'activity') {
                                data.forEach(row => {
                                    ['clicks', 'mouseMovements', 'scrolls', 'keyEvents', 'idleTimes', 'pageEntries', 'pageExits', 'pageUrls'].forEach(field => {
                                        if (Array.isArray(row[field])) {
                                            row[field] = row[field].map(item => JSON.stringify(item)).join(", ");
                                        } else if (typeof row[field] === 'object' && row[field] !== null) {
                                            row[field] = JSON.stringify(row[field]);
                                        }
                                    });
                                });
                            }
                    
                            // Assign processed data to grid
                            const grid = document.querySelector(`#${type}-container`);
                            grid.data = data;
                        });
                });
            }

            document.addEventListener("DOMContentLoaded", function () {
                fetchDataAndPopulateGrid();
            });
        </script>        
    </head>
    <body>
        <h1>User Data</h1>
        <zing-grid id="static-container"
            caption="Static Data"
            sorter
            search
            pager
            page-size=5
            data='[]'>
        </zing-grid>
        <zing-grid id="performance-container"
            caption="Performance Data"
            sorter
            search
            pager
            page-size=5
            data='[]'>
        </zing-grid>
        <zing-grid id="activity-container"
            caption="Activity Data"
            sorter
            search
            pager
            page-size=5
            data='[]'>
        </zing-grid>
    </body>
</html>
